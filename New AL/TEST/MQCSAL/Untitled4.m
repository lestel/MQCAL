data=[1,1,1,0.999999999998739,0.846588357161711,0.520941741954209,0.919567645051510,0.0384550820306892,0.257152031475073,0.468989584955948,0.664807913681915,0.370025023050515,0.112431839290963,0.165671330874050,0.175595483068744,0.546546756879750,0.339154320154711,0.382742184580234,0.734184305769092,0.0813869221062697,0.198796921345221,0.438599565844814,0.317196528817548,0.112594418651939,0.150385944990132,0.00818883866168933,0.100220272942560,0.0448596888852625,0.118226615622804,0.650992264661924,0.0507891706002084,0.0366835245518048,0.174106814641644,0.0823556367252649,0.384195367016911,0.276037651792348,0.189506895308693;0,0,1.34750291644123e-137,1.26117194984300e-12,0.153411642838289,0.479058258045791,0.0804323549484904,0.961544917969311,0.742847968524927,0.531010415044052,0.335192086318085,0.629974976949485,0.887568160709037,0.834328669125950,0.824404516931256,0.453453243120250,0.660845679845289,0.617257815419766,0.265815694230908,0.918613077893730,0.801203078654779,0.561400434155186,0.682803471182452,0.887405581348061,0.849614055009868,0.991811161338311,0.899779727057441,0.955140311114738,0.881773384377196,0.349007735338076,0.949210829399792,0.963316475448195,0.825893185358356,0.917644363274735,0.615804632983089,0.723962348207652,0.810493104691307;1,1,1,0.999999999998731,0.846285735637850,0.800720830742733,0.939792515956967,0.978275216932503,0.946574338553774,0.852621797937001,0.898021752602805,0.274871697454846,0.339595185985035,0.783937956501685,0.572981523022702,0.769857827585058,0.920861379391558,0.663379699779158,0.619971961034670,0.711809202519929,0.752822360546179,0.504327256164160,0.484325100494031,0.594894786964496,0.914640615229804,0.263822332148611,0.984725654828409,0.460856056828921,0.475239898088100,0.208584387403321,0.119635868763800,0.697594960495686,0.675725339161957,0.335554758260053,0.204486661606636,0.0690698782705517,0.0213740635164341;0,0,4.54626119378293e-138,1.26940744050716e-12,0.153714264362151,0.199279169257267,0.0602074840430325,0.0217247830674969,0.0534256614462259,0.147378202062999,0.101978247397195,0.725128302545154,0.660404814014965,0.216062043498315,0.427018476977298,0.230142172414942,0.0791386206084418,0.336620300220842,0.380028038965330,0.288190797480071,0.247177639453821,0.495672743835840,0.515674899505969,0.405105213035504,0.0853593847701961,0.736177667851389,0.0152743451715908,0.539143943171079,0.524760101911900,0.791415612596679,0.880364131236200,0.302405039504314,0.324274660838043,0.664445241739947,0.795513338393364,0.930930121729448,0.978625936483566];
data1=[ones(1,37);zeros(1,37);0.5*ones(1,37);0.5*ones(1,37)];

dat(1,:)=smooth(data(1,:));
dat(2,:)=smooth(data(2,:));
dat(3,:)=smooth(data(3,:));
dat(4,:)=smooth(data(4,:));

